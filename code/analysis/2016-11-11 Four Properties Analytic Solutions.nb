(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32743,        932]
NotebookOptionsPosition[     31453,        888]
NotebookOutlinePosition[     31948,        905]
CellTagsIndexPosition[     31905,        902]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"[", 
   SubscriptBox["EC", "50"], "]"}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsubsection",
 CellChangeTimes->{{3.6878521114095507`*^9, 3.687852113317878*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "@", 
  RowBox[{"Quiet", "@", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               FractionBox["c", "KA"]}], ")"}], "n"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["c", "KA"]}], ")"}], "n"], "+", 
             RowBox[{
              SuperscriptBox["E", 
               RowBox[{"-", "\[Beta]\[Epsilon]AI"}]], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox["c", "KI"]}], ")"}], "n"]}]}]], 
           FractionBox["R", "Nns"], 
           SuperscriptBox["E", 
            RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
        RowBox[{"-", "1"}]]}], "\[Equal]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"1", "+", 
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]AI"}]]}]], 
           FractionBox["R", "Nns"], 
           SuperscriptBox["E", 
            RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
        RowBox[{"-", "1"}]], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"1", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["KA", "KI"], ")"}], "n"], 
              SuperscriptBox["E", 
               RowBox[{"-", "\[Beta]\[Epsilon]AI"}]]}]}]], 
           FractionBox["R", "Nns"], 
           SuperscriptBox["E", 
            RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
        RowBox[{"-", "1"}]]}]}], ",", "c"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.68785077564616*^9, 3.6878508521238947`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"c", "\[Rule]", 
    RowBox[{"KA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"KA", "-", "KI"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"KA", "-", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "n"]}]], " ", "KI", 
           " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[Beta]\[Epsilon]AI", "+", "\[Beta]\[Epsilon]RA"}]], 
               " ", "Nns"}], "-", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   FractionBox["KA", "KI"], ")"}], "n"]}], ")"}], " ", 
               "Nns"}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
               "R"}]}], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "/", "n"}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                  " ", "Nns"}], "+", "R"}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 FractionBox["KA", "KI"], ")"}], "n"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                  " ", "Nns"}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], 
                  " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                    " ", "Nns"}], "+", "R"}], ")"}]}]}], ")"}]}]}], ")"}], 
            FractionBox["1", "n"]]}]}], ")"}]}]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.687850809006662*^9, 3.68785085398003*^9}}]
}, Open  ]],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["c", 
    SubscriptBox["K", "A"]], "=", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    FractionBox[
     RowBox[{
      FractionBox[
       SubscriptBox["K", "A"], 
       SubscriptBox["K", "I"]], "-", "1"}], 
     RowBox[{
      FractionBox[
       SubscriptBox["K", "A"], 
       SubscriptBox["K", "I"]], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
             RowBox[{"A", ",", "I"}]]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                RowBox[{"R", ",", "A"}]]], 
              SubscriptBox["N", "NS"]}], "+", "R"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              SubscriptBox["K", "A"], 
              SubscriptBox["K", "I"]], ")"}], "n"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                RowBox[{"R", ",", "A"}]]], " ", 
              SubscriptBox["N", "NS"]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                RowBox[{"A", ",", "I"}]]], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                   RowBox[{"R", ",", "A"}]]], " ", 
                 SubscriptBox["N", "NS"]}], "+", "R"}], ")"}]}]}], ")"}]}]}], 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
             RowBox[{"A", ",", "I"}]]], 
           SuperscriptBox["\[ExponentialE]", 
            SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
             RowBox[{"R", ",", "A"}]]], " ", 
           SubscriptBox["N", "NS"]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
             RowBox[{"R", ",", "A"}]]], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox[
                SubscriptBox["K", "A"], 
                SubscriptBox["K", "I"]], ")"}], "n"]}], ")"}], " ", 
           SubscriptBox["N", "NS"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
             RowBox[{"A", ",", "I"}]]], " ", "R"}]}]], ")"}], 
       FractionBox["1", "n"]]}]]}]}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Text",
 CellChangeTimes->{{3.6878509663579197`*^9, 3.687851021741807*^9}, {
  3.6878510572402635`*^9, 3.6878511484291368`*^9}, {3.6878511824660606`*^9, 
  3.687851231364936*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["c", 
    SubscriptBox["K", "A"]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      FractionBox[
       SubscriptBox["K", "A"], 
       SubscriptBox["K", "I"]], "-", "1"}], 
     RowBox[{
      FractionBox[
       SubscriptBox["K", "A"], 
       SubscriptBox["K", "I"]], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["R", 
              SubscriptBox["N", "NS"]], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                RowBox[{"R", ",", "A"}]]}]]}]}], ")"}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              SubscriptBox["K", "A"], 
              SubscriptBox["K", "I"]], ")"}], "n"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                 RowBox[{"A", ",", "I"}]]}]]}], "+", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                FractionBox["R", 
                 SubscriptBox["N", "NS"]], 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                  SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                   RowBox[{"R", ",", "A"}]]}]]}]}], ")"}]}], ")"}]}]}], 
         RowBox[{"2", "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
              RowBox[{"A", ",", "I"}]]}]], "(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               SubscriptBox["K", "A"], 
               SubscriptBox["K", "I"]], ")"}], "n"]}], ")"}], "+", 
          RowBox[{"2", 
           FractionBox["R", 
            SubscriptBox["N", "NS"]], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
              RowBox[{"R", ",", "A"}]]}]]}]}]], ")"}], 
       FractionBox["1", "n"]]}]], "-", "1"}]}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Text",
 CellChangeTimes->{{3.6878509663579197`*^9, 3.687851021741807*^9}, {
  3.6878510572402635`*^9, 3.6878511484291368`*^9}, {3.6878511824660606`*^9, 
  3.687851231364936*^9}, {3.6878512702717195`*^9, 3.687851389584179*^9}}],

Cell[TextData[StyleBox["(might have made a mistake in one of these steps. \
Should make sure my analytic solution matches Mathematica...)",
 FontSize->18,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->RGBColor[0.5, 0, 0.5]]], "Text",
 CellChangeTimes->{{3.6878514805379543`*^9, 3.6878514923638153`*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["c", 
    SubscriptBox["K", "A"]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      FractionBox[
       SubscriptBox["K", "A"], 
       SubscriptBox["K", "I"]], "-", "1"}], 
     RowBox[{
      FractionBox[
       SubscriptBox["K", "A"], 
       SubscriptBox["K", "I"]], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["R", 
              SubscriptBox["N", "NS"]], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                RowBox[{"R", ",", "A"}]]}]]}]}], ")"}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              SubscriptBox["K", "A"], 
              SubscriptBox["K", "I"]], ")"}], "n"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                 RowBox[{"A", ",", "I"}]]}]]}], "+", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                FractionBox["R", 
                 SubscriptBox["N", "NS"]], 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                  SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                   RowBox[{"R", ",", "A"}]]}]]}]}], ")"}]}], ")"}]}]}], 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              FractionBox["R", 
               SubscriptBox["N", "NS"]], 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
                 RowBox[{"R", ",", "A"}]]}]]}]}], ")"}]}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
             RowBox[{"A", ",", "I"}]]}]], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              SubscriptBox["K", "A"], 
              SubscriptBox["K", "I"]], ")"}], "n"], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             SubscriptBox["\[Beta]\[CapitalDelta]\[Epsilon]", 
              RowBox[{"A", ",", "I"}]]}]]}]}]], ")"}], 
       FractionBox["1", "n"]]}]], "-", "1"}]}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Text",
 CellChangeTimes->{{3.6878509663579197`*^9, 3.687851021741807*^9}, {
  3.6878510572402635`*^9, 3.6878511484291368`*^9}, {3.6878511824660606`*^9, 
  3.687851231364936*^9}, {3.6878512702717195`*^9, 3.687851389584179*^9}, {
  3.6878514400795617`*^9, 3.6878514631321397`*^9}, {3.6878515419161787`*^9, 
  3.687851550444536*^9}}],

Cell["Trying to simplify with assumptions", "Text",
 CellChangeTimes->{{3.68785243017138*^9, 3.687852433171858*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"0", "<", "KI", "<", "KA"}], "&&", 
    RowBox[{"0", "<", "\[Beta]\[Epsilon]AI"}], "&&", 
    RowBox[{"\[Beta]\[Epsilon]RA", "<", "0"}], "&&", 
    RowBox[{"0", "<", "Nns"}], "&&", 
    RowBox[{"0", "<", "R"}], "&&", 
    RowBox[{"n", "\[Element]", "Integers"}], "&&", 
    RowBox[{"n", ">", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68785241276797*^9, 3.687852519875822*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EC50", "=", 
  RowBox[{"First", "@", 
   RowBox[{"FullSimplify", "@", 
    RowBox[{"Quiet", "@", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox["c", "KA"]}], ")"}], "n"], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  FractionBox["c", "KA"]}], ")"}], "n"], "+", 
               RowBox[{
                SuperscriptBox["E", 
                 RowBox[{"-", "\[Beta]\[Epsilon]AI"}]], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   FractionBox["c", "KI"]}], ")"}], "n"]}]}]], 
             FractionBox["R", "Nns"], 
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
          RowBox[{"-", "1"}]]}], "\[Equal]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               SuperscriptBox["E", 
                RowBox[{"-", "\[Beta]\[Epsilon]AI"}]]}]], 
             FractionBox["R", "Nns"], 
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
          RowBox[{"-", "1"}]], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["KA", "KI"], ")"}], "n"], 
                SuperscriptBox["E", 
                 RowBox[{"-", "\[Beta]\[Epsilon]AI"}]]}]}]], 
             FractionBox["R", "Nns"], 
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
          RowBox[{"-", "1"}]]}]}], ",", "c"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.68785077564616*^9, 3.6878508521238947`*^9}, {
  3.687852594206025*^9, 3.6878525977143354`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"c", "\[Rule]", 
   RowBox[{"KA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       RowBox[{"KA", "-", "KI"}], 
       RowBox[{"KA", "-", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "n"]}]], " ", 
         "KI", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[Beta]\[Epsilon]AI", "+", "\[Beta]\[Epsilon]RA"}]], 
              " ", "Nns"}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["KA", "KI"], ")"}], "n"]}], ")"}], " ", "Nns"}],
              "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
              "R"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                 " ", "Nns"}], "+", "R"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["KA", "KI"], ")"}], "n"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                 " ", "Nns"}], "+", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], 
                 " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                    " ", "Nns"}], "+", "R"}], ")"}]}]}], ")"}]}]}]], ")"}], 
          RowBox[{
           RowBox[{"-", "1"}], "/", "n"}]]}]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6878525990507965`*^9, 3.687852600646536*^9}}]
}, Open  ]],

Cell[TextData[{
 "Is the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "2"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " case simpler?"
}], "Text",
 CellChangeTimes->{{3.6878525734896812`*^9, 3.687852575927662*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", "=", "2"}], "}"}], ",", 
   RowBox[{"FullSimplify", "@", 
    RowBox[{"Quiet", "@", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox["c", "KA"]}], ")"}], "n"], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  FractionBox["c", "KA"]}], ")"}], "n"], "+", 
               RowBox[{
                SuperscriptBox["E", 
                 RowBox[{"-", "\[Beta]\[Epsilon]AI"}]], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   FractionBox["c", "KI"]}], ")"}], "n"]}]}]], 
             FractionBox["R", "Nns"], 
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
          RowBox[{"-", "1"}]]}], "\[Equal]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               SuperscriptBox["E", 
                RowBox[{"-", "\[Beta]\[Epsilon]AI"}]]}]], 
             FractionBox["R", "Nns"], 
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
          RowBox[{"-", "1"}]], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["KA", "KI"], ")"}], "n"], 
                SuperscriptBox["E", 
                 RowBox[{"-", "\[Beta]\[Epsilon]AI"}]]}]}]], 
             FractionBox["R", "Nns"], 
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
          RowBox[{"-", "1"}]]}]}], ",", "c"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.68785077564616*^9, 3.6878508521238947`*^9}, {
  3.687852536955514*^9, 3.6878525445218835`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KA", " ", "KI", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"KA", "-", "KI"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"]}], 
              " ", "KA", " ", "Nns"}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
              "KI", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                 " ", "Nns"}], "+", "R"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", "\[Beta]\[Epsilon]RA"}]], " ", 
              SuperscriptBox["KA", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["KA", "2"], "+", 
                SuperscriptBox["KI", "2"]}], ")"}], " ", 
              SuperscriptBox["Nns", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[Beta]\[Epsilon]AI", "+", "\[Beta]\[Epsilon]RA"}]], 
              " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["KA", "4"], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["KA", "2"], " ", 
                 SuperscriptBox["KI", "2"]}], "+", 
                SuperscriptBox["KI", "4"]}], ")"}], " ", "Nns", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                 " ", "Nns"}], "+", "R"}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", "\[Beta]\[Epsilon]AI"}]], " ", 
              SuperscriptBox["KI", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["KA", "2"], "+", 
                SuperscriptBox["KI", "2"]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                  " ", "Nns"}], "+", "R"}], ")"}], "2"]}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"KA", "+", "KI"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], " ", 
           SuperscriptBox["KA", "2"], " ", "Nns"}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
           SuperscriptBox["KI", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], " ", 
              "Nns"}], "+", "R"}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KA", " ", "KI", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"KA", "-", "KI"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"]}], 
              " ", "KA", " ", "Nns"}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
              "KI", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                 " ", "Nns"}], "+", "R"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", "\[Beta]\[Epsilon]RA"}]], " ", 
              SuperscriptBox["KA", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["KA", "2"], "+", 
                SuperscriptBox["KI", "2"]}], ")"}], " ", 
              SuperscriptBox["Nns", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[Beta]\[Epsilon]AI", "+", "\[Beta]\[Epsilon]RA"}]], 
              " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["KA", "4"], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["KA", "2"], " ", 
                 SuperscriptBox["KI", "2"]}], "+", 
                SuperscriptBox["KI", "4"]}], ")"}], " ", "Nns", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                 " ", "Nns"}], "+", "R"}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", "\[Beta]\[Epsilon]AI"}]], " ", 
              SuperscriptBox["KI", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["KA", "2"], "+", 
                SuperscriptBox["KI", "2"]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], 
                  " ", "Nns"}], "+", "R"}], ")"}], "2"]}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"KA", "+", "KI"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], " ", 
           SuperscriptBox["KA", "2"], " ", "Nns"}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]AI"], " ", 
           SuperscriptBox["KI", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", "\[Beta]\[Epsilon]RA"], " ", 
              "Nns"}], "+", "R"}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6878525600549083`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Effective Hill Coefficient", "Subsubsection",
 CellChangeTimes->{{3.687852105741082*^9, 3.687852108893382*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"h", "=", 
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"2", "c", " ", 
      RowBox[{
       FractionBox["\[DifferentialD]", 
        RowBox[{"\[DifferentialD]", "c"}]], 
       RowBox[{"[", 
        RowBox[{"fold", "-", "change"}], "]"}]}]}], ")"}], 
    RowBox[{"c", "=", 
     RowBox[{"[", 
      SubscriptBox["EC", "50"], "]"}]}]]}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Text",
 CellChangeTimes->{{3.687852141084692*^9, 3.687852159860526*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"2", " ", "c", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              FractionBox["c", "KA"]}], ")"}], "n"], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               FractionBox["c", "KA"]}], ")"}], "n"], "+", 
            RowBox[{
             SuperscriptBox["E", 
              RowBox[{"-", "\[Beta]\[Epsilon]AI"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["c", "KI"]}], ")"}], "n"]}]}]], 
          FractionBox["R", "Nns"], 
          SuperscriptBox["E", 
           RowBox[{"-", "\[Beta]\[Epsilon]RA"}]]}]}], ")"}], 
       RowBox[{"-", "1"}]], ",", "c"}], "]"}]}], "/.", "EC50"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6878521615325885`*^9, 3.687852221814313*^9}, 
   3.6878526053814507`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.687852736118595*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1520, 781},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "C:", "Users", "talei", 
   "Dropbox", "Mathematica"}, "TalStyle.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 227, 5, 75, "Subsubsection"],
Cell[CellGroupData[{
Cell[832, 31, 2091, 61, 279, "Input"],
Cell[2926, 94, 2633, 69, 214, "Output"]
}, Open  ]],
Cell[5574, 166, 3254, 84, 173, "Text"],
Cell[8831, 252, 2692, 73, 173, "Text"],
Cell[11526, 327, 312, 6, 116, "Text"],
Cell[11841, 335, 3026, 81, 173, "Text"],
Cell[14870, 418, 116, 1, 61, "Text"],
Cell[14989, 421, 464, 11, 60, "Input"],
Cell[CellGroupData[{
Cell[15478, 436, 2314, 64, 380, "Input"],
Cell[17795, 502, 2382, 62, 185, "Output"]
}, Open  ]],
Cell[20192, 567, 232, 8, 61, "Text"],
Cell[CellGroupData[{
Cell[20449, 579, 2390, 67, 397, "Input"],
Cell[22842, 648, 6680, 172, 392, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29571, 826, 117, 1, 75, "Subsubsection"],
Cell[29691, 829, 516, 15, 72, "Text"],
Cell[CellGroupData[{
Cell[30232, 848, 1113, 33, 147, "Input"],
Cell[31348, 883, 77, 1, 84, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

